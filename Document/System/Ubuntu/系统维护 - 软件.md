> [!NOTE]
>
> 安装常用压缩工具
>
> ```
> sudo apt update
> sudo apt install zip unzip p7zip-full rar unrar tar gzip bzip2 xz-utils
> ```

## 打压缩包

### ZIP 格式

#### 使用 `zip` 命令

```bash
# 压缩文件或目录
zip -r archive.zip file_or_folder

# 压缩多个文件或目录
zip -r archive.zip file1 file2 folder1

# 不压缩，仅打包（存储模式）
zip -0 -r archive.zip folder

# 设置压缩级别（0-9，9 为最高压缩率）
zip -r -9 archive.zip folder

# 排除某些文件
zip -r archive.zip folder -x "*.log" "temp/*"

# 分卷压缩（每卷 50MB）
zip -r -s 50m archive.zip folder

# 创建加密压缩包
zip -r -e archive.zip folder
```

#### 查看已压缩的 ZIP 文件信息

```bash
zipinfo archive.zip
```

### TAR 及相关格式

#### 使用 `tar` 打包

```bash
# 打包目录为 .tar 文件（不压缩）
tar -cf archive.tar folder

# 打包并压缩为 .tar.gz（或 .tgz）
tar -czf archive.tar.gz folder

# 打包并压缩为 .tar.bz2
tar -cjf archive.tar.bz2 folder

# 打包并压缩为 .tar.xz
tar -cJf archive.tar.xz folder

# 打包多个文件或目录
tar -czf archive.tar.gz file1 file2 folder1

# 排除某些文件或目录
tar -czf archive.tar.gz --exclude="*.log" --exclude="temp" folder
```

### RAR 格式

#### 使用 `rar` 命令

```bash
# 压缩目录为 .rar 文件
rar a archive.rar folder

# 压缩时设置密码
rar a -p archive.rar folder

# 分卷压缩（每卷 100MB）
rar a -v100m archive.rar folder

# 压缩并删除原文件
rar m archive.rar folder

# 设置压缩级别（0-5，5 为最高压缩率）
rar a -m5 archive.rar folder
```

### 7Z 格式

#### 使用 `7z` 命令

```bash
# 压缩目录为 .7z 文件
7z a archive.7z folder

# 压缩多个文件或目录
7z a archive.7z file1 file2 folder1

# 设置压缩级别（0-9，9 为最高压缩率）
7z a -mx=9 archive.7z folder

# 压缩并加密
7z a -p archive.7z folder

# 分卷压缩（每卷 100MB）
7z a -v100m archive.7z folder

# 排除某些文件
7z a archive.7z folder -x!*.log -x!temp
```

### 附录

#### 常用压缩命令总结

| 格式      | 压缩命令                              | 解压命令（供参考）                  |
| ------- | --------------------------------- | -------------------------- |
| ZIP     | `zip -r archive.zip folder`       | `unzip archive.zip`        |
| TAR.GZ  | `tar -czf archive.tar.gz folder`  | `tar -xzf archive.tar.gz`  |
| TAR.BZ2 | `tar -cjf archive.tar.bz2 folder` | `tar -xjf archive.tar.bz2` |
| TAR.XZ  | `tar -cJf archive.tar.xz folder`  | `tar -xJf archive.tar.xz`  |
| RAR     | `rar a archive.rar folder`        | `unrar x archive.rar`      |
| 7Z      | `7z a archive.7z folder`          | `7z x archive.7z`          |

## 解压缩包

### ZIP 格式

#### 使用 `unzip`

```bash
# 安装（如未安装）
sudo apt install unzip

# 解压到当前目录
unzip file.zip

# 解压到指定目录
unzip file.zip -d /path/to/directory

# 查看压缩包内容（不解压）
unzip -l file.zip

# 解压特定文件
unzip file.zip specific_file.txt

# 安静模式解压（不显示进度）
unzip -q file.zip

# 覆盖已存在文件
unzip -o file.zip

# 不覆盖已存在文件
unzip -n file.zip
```

#### 使用 `zip` 工具查看

```bash
# 查看压缩包信息
zipinfo file.zip
```

### TAR.GZ / TGZ 格式

#### 基本解压

```bash
# .tar.gz 或 .tgz 文件
tar -xzf file.tar.gz

# 解压到指定目录
tar -xzf file.tar.gz -C /path/to/directory

# 查看内容
tar -tzf file.tar.gz

# 详细模式解压（显示文件列表）
tar -xvzf file.tar.gz
```

####  其他 tar 相关格式

```bash
# .tar.bz2 文件
tar -xjf file.tar.bz2

# .tar.xz 文件
tar -xJf file.tar.xz

# .tar 文件（未压缩）
tar -xf file.tar
```

### RAR 格式

#### 使用 `unrar`

```bash
# 安装
sudo apt install unrar

# 解压到当前目录
unrar x file.rar

# 解压到指定目录
unrar x file.rar /path/to/directory/

# 查看压缩包内容
unrar l file.rar

# 测试压缩包完整性
unrar t file.rar

# 解压但不创建目录结构
unrar e file.rar
```

- **`x`**：保持目录结构
- **`e`**：解压所有文件到当前目录，不创建子目录

#### 使用 `rar`

```bash
# 安装
sudo apt install rar

# 解压（与 unrar 类似）
rar x file.rar
```

### 7Z 格式

#### 使用 `7z` 或 `7za`

```bash
# 安装
sudo apt install p7zip-full

# 解压到当前目录
7z x file.7z

# 解压到指定目录
7z x file.7z -o/path/to/directory

# 查看内容
7z l file.7z

# 测试完整性
7z t file.7z

# 解压特定文件
7z x file.7z specific_file.txt

# 解压但不创建目录结构
7z e file.7z
```

### 附录

- **zip** → `unzip`
- **rar** → `unrar`（注意参数：x=保持目录，e=平铺文件）
- **7z** → `7z x`
- **tar.gz** → `tar -xzf`
- **tar.bz2** → `tar -xjf`
- **tar.xz** → `tar -xJf`

## 软件安装

### APT

#### 安装

这是Ubuntu官方推荐的方式，自动处理依赖关系，易于升级和卸载。适用于大多数软件安装：

```bash
# 安装
sudo apt install <包名>

# 升级
sudo apt update
sudo apt upgrade

# 删除
sudo apt remove <包名>
```

#### 卸载

```bash
# 1. 标准卸载（保留配置文件）
sudo apt remove <包名>

# 2. 彻底卸载（删除配置文件）
sudo apt purge <包名>

# 3. 删除不再需要的依赖包
sudo apt autoremove

# 4. 检查是否有残留配置
sudo apt autoremove --purge
```

**进阶清理**

```bash
# 查看软件包安装的所有文件
dpkg -L <包名>

# 查找相关配置文件
find /etc -name "*<包名>*"
find ~/ -name "*<包名>*"

# 清理APT缓存
sudo apt clean          # 删除所有缓存
sudo apt autoclean      # 只删除旧版本缓存
```

### DEB包安装

#### 安装

```bash
# 安装
sudo dpkg -i <包名>.deb

# 修复依赖
sudo apt install -f
```

#### 卸载

```bash
# 1. 使用dpkg卸载
sudo dpkg -r <包名>      # 卸载但保留配置
sudo dpkg -P <包名>      # 彻底卸载

# 2. 如果dpkg卸载失败，先用apt修复
sudo apt remove <包名>
```

### TAR包安装

#### 安装

```bash
# 解压
tar -xzf <包名>.tar.gz

# 进入目录
cd <解压后的目录>

# 配置
./configure

# 编译
make

# 安装
sudo make install
```

#### 卸载

```bash
# 1. 卸载软件
sudo snap remove <包名>

# 2. 查看和删除旧版本（自动）
sudo snap remove <包名> --purge

# 3. 查看snap安装的所有包
snap list

# 4. 清理snap缓存（谨慎使用）
sudo rm -rf /var/lib/snapd/cache/*
```

### Appimage

```bash
# 安装AppImageLauncher
sudo add-apt-repository ppa:appimagelauncher-team/stable
sudo apt update
sudo apt install appimagelauncher

# 安装后，双击AppImage文件会自动集成到系统
```

### Snap包

Ubuntu App Center 默认提供了这些软件，如需使用可在其中直接下载。不过目前部分应用仍存在一些问题，例如 Obsidian：若从 App Center 安装，可能会出现无法输入中文的情况^[2025-12-16 ]。建议改用 Deb 包或 AppImage 版本来解决。期待后续版本能够修复这一问题。

**优点**：跨发行版、自动更新、沙盒安全。
**缺点**：启动较慢，占用磁盘空间较多。

```bash
sudo snap install <包名>
```

### Flatpak

**优点**：跨发行版、沙盒安全。
**缺点**：类似Snap，占用空间较大。

```bash
# 安装命令
flatpak install <包名>

# 需先安装Flatpak
sudo apt install flatpak
```

### 安装包清理

#### 定期清理

```bash
sudo apt autoremove --purge
sudo apt clean
flatpak uninstall --unused

# 删除过时的包缓存
sudo apt autoclean   

# 删除所有包缓存（慎用）
sudo apt clean      

# 移除自动安装且不再需要的依赖
sudo apt autoremove 

# 注意：可能清除部分应用状态
rm -rf ~/.cache/*    
```

#### 其他工具

```bash
# 保留7天内日志
sudo journalctl --vacuum-time=7d  

# 图形化清理工具
sudo apt install stacer bleachbit  
```

### 清理脚本

```bash
#!/bin/bash
# clean_package.sh

PACKAGE="$1"

echo "=== 清理包: $PACKAGE ==="

# 1. 尝试用apt卸载
sudo apt purge $PACKAGE 2>/dev/null

# 2. 查找残留
echo "=== 查找配置文件 ==="
find /etc -name "*$PACKAGE*" 2>/dev/null
find ~/ -name "*$PACKAGE*" 2>/dev/null

# 3. 询问是否删除
read -p "是否删除以上找到的文件？(y/N): " confirm
if [[ $confirm == "y" ]]; then
    sudo find /etc -name "*$PACKAGE*" -delete 2>/dev/null
    find ~/ -name "*$PACKAGE*" -delete 2>/dev/null
fi

echo "=== 清理完成 ==="
```

### 专业排查工具

#### 1. 使用 `deborphan` 查找孤立包

```bash
sudo apt install deborphan
deborphan    # 列出不再需要的库包
```

#### 2. 使用 `aptitude` 分析依赖

```bash
sudo aptitude remove <包名>
# 会显示详细的依赖关系
```

#### 3. 检查服务残留

```bash
# 查看是否有相关服务
systemctl list-units --all | grep <包名>

# 停止并禁用服务
sudo systemctl stop <服务名>
sudo systemctl disable <服务名>

# 删除服务文件
sudo rm /etc/systemd/system/<服务名>.service
```

#### 4. 使用 `lsof` 查看文件使用情况

```bash
# 查看哪些进程在使用某个目录/文件
sudo lsof /usr/local/<包名目录>/
```
