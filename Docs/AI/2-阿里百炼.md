## 入门学习

大模型创建参考：[[训练大模型]]

## 阿里百炼

**首页**：https://bailian.console.aliyun.com/?spm=5176.12818093_47.console-base_search-panel.dtab-product_sfm.5b822cc9mDtlE3&scm=20140722.S_sfm._.ID_sfm-RL_%E5%B9%B3%E5%8F%B0%E7%99%BE%E7%82%BC-LOC_console_console-OR_ser-V_4-P0_0#/home

**模型广场**：https://bailian.console.aliyun.com/?tab=model#/model-market/all

**密钥管理**：https://bailian.console.aliyun.com/?tab=model#/api-key

### 接口说明

**请求地址**：  
`https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions`

**请求示例**：

```json
{
  "model": "qwen3-max",
  "messages": [
    {
      "role": "system",
      "content": "我是Bunny，请以Bunny方式回答。"
    },
    {
      "role": "user",
      "content": "你是谁？"
    }
  ],
  "stream": false
}
```

#### 参数说明

| 字段          | 解释                                                         |
| ------------- | ------------------------------------------------------------ |
| model         | 需要使用的模型名称                                           |
| role          | 当前消息的角色                                               |
| stream        | `true` 为流式返回，逐步响应；`false` 为阻塞式返回，一次性返回完整结果 |
| enable_search | 是否启用联网搜索功能                                         |

#### 角色字段说明

- **system**：系统设定的角色，用于设定对话的背景或行为方式。
- **user**：用户发送的消息。
- **assistant**：模型之前的回复，用于构建上下文（由于大模型本身不具备记忆功能，需通过此方式维持对话上下文）。

**上下文构建示例**：

```json
{
  "model": "qwen3-max",
  "messages": [
    {
      "role": "system",
      "content": "我是Bunny，请以Bunny方式回答。"
    },
    {
      "role": "user",
      "content": "你是谁？"
    },
    {
      "role": "assistant",
      "content": "我是Bunny，很高兴为您服务！"
    },
    {
      "role": "user",
      "content": "介绍一下你自己。"
    }
  ],
  "stream": false
}
```

### 使用说明

#### 启用联网搜索

通过设置 `"enable_search": true`，可以允许模型在回答时获取最新的网络信息。

**请求示例**：

```json
{
  "model": "deepseek-v3",
  "messages": [
    {
      "role": "system",
      "content": "我是Bunny，请以Bunny方式回答。"
    },
    {
      "role": "user",
      "content": "列举最新2025年的五条新闻，并标注时间。"
    }
  ],
  "stream": false,
  "enable_search": true
}
```

**响应示例**：

```json
{
  "choices": [
    {
      "message": {
        "content": "1. **2025年11月10日** - 第十五届全国运动会在广东奥林匹克体育中心开幕，这是党的二十大后举办的首届全运会。（国内体育盛事）  \n2. **2025年11月9日** - 中科宇航力箭一号遥九运载火箭成功发射，将楚天二号技术试验01星、02星送入轨道。（航天科技）  \n3. **2025年11月9日** - 韩国海域中国渔船倾覆致2死3失踪，中国驻光州总领馆介入。（国际突发事件）  \n4. **2025年11月12日** - 江苏举办人工智能OPC大会，省长刘小涛致辞并见证全运会柔道金牌诞生。（地方科技+体育）  \n5. **2025年11月10日** - 美国联邦政府“停摆”持续，民航业受冲击致千余航班取消。（国际政治经济）  \n\n（时间均标注为新闻发布日期，Bunny式简洁排版，重点加粗～）",
        "role": "assistant"
      },
      "finish_reason": "stop",
      "index": 0,
      "logprobs": null
    }
  ],
  "object": "chat.completion",
  "usage": {
    "prompt_tokens": 1994,
    "completion_tokens": 217,
    "total_tokens": 2211
  },
  "created": 1762963854,
  "system_fingerprint": null,
  "model": "deepseek-v3",
  "id": "chatcmpl-a2c18bfe-63e5-47cd-bb5a-ce47e8b9e49e"
}
```

#### 完整请求参数列表

详情参考：https://bailian.console.aliyun.com/?tab=api#/api/?type=model&url=2712576

```json
{
  "model": "qwen-plus",
  "messages": [
    {
      "role": "system",
      "content": "你是助手Bunny"
    },
    {
      "role": "user", 
      "content": "你好"
    }
  ],
  "stream": false,
  "temperature": 0.8,
  "top_p": 0.9,
  "max_tokens": 1500,
  "stop": ["\n", "。", "!"],
  "enable_search": true,
  "repetition_penalty": 1.1,
  "presence_penalty": 0.5,
  "frequency_penalty": 0.5,
  "tools": [...],
  "tool_choice": "auto"
}
```

#### 详细参数说明

| 参数名               | 类型    | 默认值 | 说明                                             |
| -------------------- | ------- | ------ | ------------------------------------------------ |
| `model`              | string  | 必填   | 模型名称，如：qwen-plus、qwen-max、deepseek-v3等 |
| `messages`           | array   | 必填   | 对话消息列表                                     |
| `stream`             | boolean | false  | 是否流式输出                                     |
| `temperature`        | float   | 1.0    | 采样温度，范围 [0, 2]，值越高输出越随机          |
| `top_p`              | float   | 1.0    | 核采样概率，范围 (0, 1]，与temperature二选一使用 |
| `max_tokens`         | integer | 1500   | 生成结果的最大token数                            |
| `stop`               | array   | null   | 停止序列，遇到这些字符串时停止生成               |
| `enable_search`      | boolean | false  | 是否启用联网搜索                                 |
| `repetition_penalty` | float   | 1.0    | 重复惩罚系数，>1降低重复，<1增加重复             |
| `presence_penalty`   | float   | 0.0    | 主题重复惩罚，惩罚已经出现过的token              |
| `frequency_penalty`  | float   | 0.0    | 频率惩罚，惩罚出现频率高的token                  |
| `tools`              | array   | null   | 可用的工具函数列表                               |
| `tool_choice`        | string  | "auto" | 工具调用策略："auto"、"none"或指定工具           |

#### 高级功能参数示例

**1. 控制生成随机性**

```json
{
  "model": "qwen-max",
  "messages": [
    {
      "role": "user",
      "content": "写一首关于春天的诗"
    }
  ],
  "temperature": 0.7,
  "top_p": 0.9,
  "max_tokens": 500
}
```

**2. 设置停止条件**

```json
{
  "model": "qwen-plus", 
  "messages": [
    {
      "role": "user",
      "content": "请列出五个编程语言"
    }
  ],
  "stop": ["6.", "\n\n"],
  "max_tokens": 200
}
```

**3. 惩罚重复内容**

```json
{
  "model": "deepseek-v3",
  "messages": [
    {
      "role": "user", 
      "content": "详细描述人工智能的发展历程"
    }
  ],
  "repetition_penalty": 1.2,
  "frequency_penalty": 0.8,
  "max_tokens": 1000
}
```

**4. 工具调用功能**

```json
{
  "model": "qwen-max",
  "messages": [
    {
      "role": "user",
      "content": "今天北京的天气怎么样？"
    }
  ],
  "tools": [
    {
      "type": "function",
      "function": {
        "name": "get_weather",
        "description": "获取城市天气信息",
        "parameters": {
          "type": "object",
          "properties": {
            "city": {
              "type": "string",
              "description": "城市名称"
            }
          },
          "required": ["city"]
        }
      }
    }
  ],
  "tool_choice": "auto"
}
```

#### 响应参数说明

响应中包含的字段：

| 字段名               | 类型    | 说明                               |
| -------------------- | ------- | ---------------------------------- |
| `id`                 | string  | 本次请求的唯一ID                   |
| `object`             | string  | 对象类型，通常是 "chat.completion" |
| `created`            | integer | 请求创建的时间戳                   |
| `model`              | string  | 使用的模型名称                     |
| `choices`            | array   | 生成的结果列表                     |
| `usage`              | object  | token使用情况统计                  |
| `system_fingerprint` | string  | 系统指纹标识                       |

